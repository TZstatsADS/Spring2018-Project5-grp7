---
title: "logistic regression"
output: html_document
---

```{r}
library(glmnet)
```

#(1)
#feature
```{r}
train <- read.csv("../output/logistic_shiny_train.csv",header = FALSE,as.is = T)
test <- read.csv("../output/logistic_shiny_test.csv",header = FALSE,as.is = T)

train_y <- train[,1]
test_y <- test[,1]

train_x <- train[,-1]*1.0
test_x <- test[,-1]*1.0
train_sparse <- sparse.model.matrix(~.,train_x)
test_sparse <- sparse.model.matrix(~.,test_x)
```

#cross validation
```{r,warning=FALSE}
fit <- cv.glmnet(train_sparse, train_y, nfolds = 5, family = "multinomial")
plot(fit,main = "logistic-feature")
save(fit, file = "../output/logistic_model_shiny.RData")
```

```{r}
#best lambda
lambda <- fit$lambda.min
lambda

pred <- predict(fit, test_sparse, type="class", s=lambda)

error <- mean(pred != test_y)
error
```

